<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/style.css" type="text/css"/><title>Ranged combat in Dregsrealm</title>
<meta name="description" content="One of the bigger features still missing from Dregsrealm is ranged combat.">
<meta property="og:title" content="Ranged combat in Dregsrealm">
<meta property="og:type" content="website">
<meta property="og:image" content="https://jarizleifr.github.io/img/jarizleifr.jpg">
<meta property="og:url" content="https://jarizleifr.github.io/posts/ranged-combat-in-dregsrealm.html">
<meta property="og:description" content="One of the bigger features still missing from Dregsrealm is ranged combat.">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"></head>
<body>
<nav>
  <ol>
    <li>
      <a href="/index.html">
	<img src="/img/sigil.png" width="40" height="30" alt="Jarizleifr's Web of Weird"/>
      </a>
    </li>
    <li>
      <a href="/posts/archive.html">Archive</a>
    </li>
    <li>
      <a href="/gallery.html">Gallery</a>
    </li>
    <li>
      <a href="/resume.html">Resume</a>
    </li>
  </ol>
</nav>

<div id="content">
<div class="tags"><a href="/posts/tag-gamedev.html">:gamedev</a></div>
<header><h1>Ranged combat in Dregsrealm</h1><h4><span class="timestamp-wrapper"><span class="timestamp">&lt;2021-09-25 Sat&gt;</span></span></h4></header><p>
One of the bigger features still missing from Dregsrealm is ranged combat. After revamping my effects system, plenty of monsters got some quite nasty status-effect causing melee attacks, so being able to pick them out from afar started becoming a necessity.
</p>

<p>
I did implement a quick and dirty prototype of that when I was still running the game in libtcod, so I have a pretty good idea of how to implement stuff like projectile queues and animations, but turning the actual ranged weaponry into ECS components turned out to be more complex issue than I anticipated.
</p>

<p>
Currently I have separate components for <code>C_RangedAttack</code> and <code>C_RangedWeapon</code>. <code>C_RangedAttack</code> is common to creatures, weapon items and ammunition items, while <code>C_RangedWeapon</code> is only available for creatures and weapon items. The problem I'm trying to solve here is how to get some base value from the creature, modify it with the weapon value and then modify it again with the ammunition value.
</p>

<p>
For example, a person might have a talent that decreases their spread with a particular weapon, they might use a weapon that is by default very inaccurate, but again they might use ammunition that decreases weapon spread. Then the person drinks a sharpshooter potion to make themselves even more accurate. So the <code>spread</code> value absolutely needs to be cached on the Creature entity. But it needs to be cached on the weapon, on the ammunition, on the talent effect and on the potion effect as well&#x2026;
</p>

<p>
I really should just try to get some sort of naive implementation done, but once again I got stuck trying to figure out the best struct layout so I wouldn't need more than two components to solve this.
</p>
</div>
<footer>
  <div class="contact">
    <p>Find me elsewhere:</p>
    <div>
      <a href="https://mastodon.social/@jarizleifr" rel="me"><img src="/img/mastodon.svg" alt="Mastodon" width="20" height="20"/></a>
      <a href="https://github.com/jarizleifr"><img src="/img/github.svg" alt="GitHub" width="20" height="20"/></a>
      <a href="https://www.linkedin.com/in/anttijoutsi"><img src="/img/linkedin.svg" alt="Linkedin" width="20" height="20"/></a>
    </div>
    <p>Send me an email:<br/><a href="mailto:antti.joutsi@gmail.com">antti.joutsi@gmail.com</a></p>
  </div>
  <div class="cc-by">
    <a href="https://creativecommons.org/licenses/by/4.0/">
      <img src="/img/by.svg" alt="CC-BY" />
    </a>
    <p>Text content on this website is licensed under the Creative Commons Attribution 4.0 International License.<br/>All images, except where otherwise noted, are all rights reserved Â© 2023 Antti Joutsi, and you must request a permission to use this material.</p>
  </div>
</footer>
</body>
</html>
